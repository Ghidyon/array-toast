<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />
    <link rel="stylesheet" href="css/style.css">
    <title>Array Toasts</title>
</head>

<body>

    <div class="container">
        <div class="btn-header">
            <div class="control waves-effect waves-light" id="start">Start Toast</div>
            <div class="control waves-effect waves-light" id="stop">Stop Toast</div>
        </div>
        <ul class="hide"></ul>
    </div>

    <script src="js/materialize.min.js"></script>

    <script>
        const button = document.querySelector('#start');
        const stopButton = document.querySelector('#stop');
        const ul = document.querySelector('ul');
        const items = [
            'Andela',
            'Apple',
            'Atom',
            'Backend',
            'Bing',
            'Chrome',
            'Computer',
            'Developer',
            'Ebay',
            'Facebook',
            'Frontend',
            'Full-stack',
            'Google',
            'Instagram',
            'Jumia',
            'Microsoft',
            'OPay',
            'Paypal',
            'Paystack',
            'Twitter',
            'Vanilla',
            'VS Code',
            'Web',
            'Whatsapp'];

        // Move items as lists to the DOM
        items.forEach(item => {
            const div = document.createElement('div');
            const a = document.createElement('a');
            a.textContent = item;
            const img = document.createElement('img');
            img.setAttribute('src', 'img/fly.svg');
            const badge = document.createElement('span');
            div.setAttribute('onclick', `M.toast({html: "${item}", classes: 'rounded toast-btn', completeCallback: hello()})`);
            div.classList.add('dark-blue');
            div.appendChild(a);
            div.appendChild(badge);
            div.appendChild(img);
            ul.appendChild(div);
        });

        const lists = document.querySelectorAll('a');
        const divs = document.querySelectorAll('ul div');

        // increase count of clicks
        divs.forEach(div => {
            div.addEventListener('click', e => {
                div.querySelector('span').innerHTML = Number(div.querySelector('span').innerHTML) + 1;
            })
        })

        // Display list items randomly on the DOM
        const displayItems = () => {
            const getItem = items[Math.floor(Math.random() * items.length)]; // randomly getting the index position

            // Toast List Items at random
            M.toast({ html: `${getItem}`, classes: 'rounded toast-btn' });

            // add and update badges
            lists.forEach(list => {
                if (list.textContent === getItem) {
                    if (list.nextSibling.innerHTML === '') {
                        list.nextSibling.classList.add('white');
                    }
                    list.nextSibling.innerHTML = Number(list.nextSibling.innerHTML) + 1;
                    list.parentElement.classList.add('z-depth', 'border');
                }
                else {
                    list.parentElement.classList.remove('z-depth', 'border');
                }
            })
        }

        const hello = () => {
            console.log(parent);
        }

        // display list items on button click
        const buttonToast = () => {
            let startToast;
            stopButton.classList.add('disable');
            button.addEventListener('click', e => {
                button.disabled = true;
                button.classList.add('disable');
                stopButton.classList.remove('disable');
                ul.classList.remove('hide');
                startToast = setInterval(displayItems, 5000);
            });
            stopButton.addEventListener('click', e => {
                stopButton.classList.add('disable');
                stopButton.disabled = true;
                button.classList.remove('disable');
                ul.classList.add('hide');
                clearInterval(startToast);
            });
        }

        buttonToast();
    </script>

    <!-- -- Week 3 Presentation
         The entire page should be fine -- Done
         Create an array, nothing less than 20 to 30 itmes -- Done
         When you click on the list item, it should be toasted. -- Done
         each of the list you record the number of times it has been toasted. -- Done
         Start button -- Done
         Stop button -- Done
    -->
</body>

</html>